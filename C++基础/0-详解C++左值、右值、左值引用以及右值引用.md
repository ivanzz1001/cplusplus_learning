# 详解 C++ 左值、右值、左值引用以及右值引用

参看:

- [详解 C++ 左值、右值、左值引用以及右值引用](https://www.cnblogs.com/david-china/p/17080072.html)

## 1. 左值和右值

### 1.1 左值

左值是一个表示数据的表达式，比如：变量名、解引用的指针变量。一般地，我们可以获取它的地址和对它赋值，但被`const`修饰后的左值，不能给它赋值，但是仍然可以取它的地址。总体而言，**可以取地址的对象就是左值**。

```c
//以下的a, p, *p, b都是左值
int a = 3;
int *p = &a;
*p;
const int b = 2;
```

### 1.2 右值

右值也是一个表示数据的表达式，比如：字面常量、表达式返回值，传值返回函数的返回值（是传值返回，而非传引用返回），右值不能出现在赋值符号的左边且不能取地址。总体而言，**不可以取地址的对象就是右值**。

```c
double x = 1.3, y = 3.8;

//以下几个都是常见的右值
10;                        //字面常量
x + y;                     //表达式返回值
fmin(x, y);                //传值返回函数的返回值
```

以下写法均不能通过编译:
```c
10 = 4; x + y = 4; fmin(x, y) = 4;    //gcc编译报错: lvalue required as left operand of assignment

&10; &(x+y); &fmin(x, y);             //gcc编译报错: lvalue required as unary ‘&’ operand
```
### 1.3 总结

区分左值和右值，终究还是要看能否取地址。


## 2. 左值引用和右值引用

传统的 C++ 语法中就存在引用语法，而C++11标准中新增了右值引用的语法特性，因此为了区分两者，将C++11标准出现之前的引用称为左值引用。

`无论左值引用还是右值引用，都是给对象取别名`.

### 2.1 左值引用

左值引用就是对左值的引用，给左值取别名。**主要作用是避免对象拷贝**

```c
//以下几个是对上面左值的引用
int& ra = a;
int*& rp = p;
int& r = *p;
const int& rb = b;
```

### 2.2 右值引用
右值引用就是对右值的引用，给右值取别名。**主要作用是把延长对象的生命周期，一般是延长到作用域的scope之外**

右值引用的表示是在具体的变量类型名称后加两个`&`， 例如: `int&& r = 4;`

```c
//以下几个是对上面右值的右值引用
int&& rr1 = 10;
double&& rr2 = x + y;
double&& rr3 = fmin(x, y);
```

1. `注意`
  
    右值引用引用右值，会使右值被存储到特定的位置。

    也就是说：右值引用变量其实是左值，可以对它取地址和赋值(const右值引用变量可以取地址但不可以赋值，因为 const 在起作用)。

    当然，取地址是指取变量空间的地址（右值是不能取地址的）。

    例如：
    ```c
    //1. 右值引用 rr2 引用右值 x + y 后，该表达式的返回值被存储到特定的位置，不能取表达式返回值 x + y 的地址，但是可以取 rr2 的地址，也可以修改 rr2
    double&& rr2 = x + y;
    &rr2;
    rr2 = 9.4;

    //2. 可以对 rr4 取地址，但不能修改 rr4，即写成rr4 = 5.3;会编译报错
    const double&& rr4 = x + y;
    &rr4;
    ```
